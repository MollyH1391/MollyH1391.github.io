@{
    ViewData["Title"] = "所有商店訂單";
    var brandId = (int)ViewData["BrandId"];
}

@section topCSS{

    <link href="~/css/_settings.css" rel="stylesheet">

    <link href="~/css/orderdetail.css" rel="stylesheet">

    <style>
        #__BVID__5___BV_tab_button__{
            font-size: 20px;
            font-weight: bold;
        }
       
    </style>
}

@section endJS{
    <script>
        const brandId = @brandId
    </script>

    <script src="~/js/OrderDetails/orderdetails_brand.js"></script>
}

<div v-cloak id="brandorderdetailVue" class="container p-0">

    <div class="row justify-content-between mb-3">
        <div class="col-4">
            <p class="my-2 ms-1 fz_18 fw-bold">請選擇分店</p>
            <template>
              <div>
                <b-form-select v-model="selected" :options="options" class="mb-3">
                  <!-- This slot appears above the options from 'options' prop -->
                  <template #first>
                    <b-form-select-option :value="null" disabled>-- 請選擇分店 --</b-form-select-option>
                  </template>
                </b-form-select>

                <div id="recordSelected" class="mt-3 position-absolute">Selected: <strong>{{ selected }}</strong></div>
              </div>
            </template>
            
        </div>
        <div class="col-6">
            <p class="my-2 ms-1 fz_18 fw-bold">搜尋</p>
            <div class="input-group">
              <div class="input-group-prepend">
                <span class="input-group-text" id="inputGroup-sizing-default">請輸入關鍵字</span>
              </div>
              <input type="text" class="form-control" v-model="filter" >
            </div>
        </div>

        <div class="col-6">
            <b-button onclick="gotoShopDetails()" >看分店明細</b-button>
        </div>
        
        <div class="col-3 d-flex justify-content-end">
            <p class="text_blue font-weight-bold">總共 {{filterCounts}} 筆</p>
        </div>
        
    </div>

    <div class="row mb-3">
        <b-card class="col-12" no-body>
            <div card fill>
                 <div title="" >
                     <p class="fz_18 fw-bold text-center my-2">所有訂單</p>
                     
                         <table id="orderTable" class="table text-center">
                         <thead>
                             <tr>
                                <th>分店</th>
                                <th>訂單編號</th>
                                <th>訂單建立時間</th>
                                <th>會員</th>
                                <th>取餐時間</th>
                                <th>取餐方式</th>
                                <th>發票方式</th>
                                <th>折價券</th>
                                <th>總價</th>
                                <th>訂單狀態</th>
                             </tr>
                         </thead>
                         <tbody>
                             <tr v-for="(order, index) in showDataList" :key="order.orderId">
                                <td class="align-middle">{{order.shopName}}</td>
                                <td v-html="highlightMatches(order.orderStamp)" class="align-middle">{{order.orderStamp}}</td>
                                <td v-html="highlightMatches(order.orderDate)" class="align-middle">{{order.orderDate}}</td>
                                <td v-html="highlightMatches(order.userName)" class="align-middle">{{order.userName}}</td>
                                <td v-html="highlightMatches(order.pickUpTime)" class="align-middle">{{order.pickUpTime}}</td>
                                <td class="align-middle">
                                    <span v-if="order.takeMethod == '外送'" class="badge badge-pill badge-success p-2">{{order.takeMethod}}</span>
                                    <span v-else class="badge badge-pill badge-warning p-2">{{order.takeMethod}}</span>
                                </td>
                                <td v-html="highlightMatches(order.receiptType)" class="align-middle">{{order.receiptType}}</td>
                                <td class="align-middle">
                                    <span v-if="order.coupon != '無折扣'" class="badge badge-info p-2">{{order.coupon}}</span>
                                    <span v-else class="">{{order.coupon}}</span>
                                </td>
                                <td class="align-middle">{{order.totalPrice}}</td>
                                <td class="align-middle">
                                    <span v-if="order.orderState == '未接單'"  class="py-2 px-3 badge badge-pill badge-danger">{{order.orderState}}</span>
                                    <span v-if="order.orderState == '已接單'"  class="py-2 px-3 badge badge-pill badge-info">{{order.orderState}}</span>
                                    <span v-if="order.orderState == '完成'"  class="py-2 px-3 badge-pill badge-success">{{order.orderState}}</span>
                                    <span v-if="order.orderState == '門市取消訂單'"  class="py-2 px-3 badge badge-pill badge-warning">{{order.orderState}}</span>
                                    <span v-if="order.orderState == '訂單取消'"  class="py-2 px-3 badge badge-pill badge-secondary">{{order.orderState}}</span>
                                </td>
                             </tr>
                         </tbody>
                     </table>
                     
                 </div>
            </div>
        </b-card>
    </div>


    <div class="row my-2">
        <div class="col-12 d-flex justify-content-center mb-5">

            <b-pagination 
                v-model="currentPage" 
                pills 
                :total-rows="total"
                :per-page="perPage"
            >
            </b-pagination>
            
        </div>
    </div>
</div>
